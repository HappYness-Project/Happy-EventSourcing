@page "/todos"
@inherits TodoBase
@using HP.Application.DTOs
@using HP.Application.Queries.Todos
@inject MediatR.IMediator _mediator

<h3>Todos</h3>
<div class="text-left bg-blue-100">
    <input class="border-4 w-1/3 rounded m-6 p-6 h-8
               border-blue-300" @bind-value="TodoIdInput"
           @bind-value:event="oninput" placeholder="Search by Todo ID" @onkeyup="@(() => SearchChanged(TodoIdInput))" />
</div>
@if (TodoDetailsFromTodoSearch is null)
{

    <div class="w-100">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>TODO ID</th>
                    <th>User ID</th>
                    <th>Title</th>
                    <th>Options</th>

                </tr>
            </thead>
            <tbody>

                @if (Todos == null)
                {
                    <tr><td><em>Loading...</em></td></tr>
                }

                @foreach (var t in Todos)
                {
                    <tr>
                        <td style="text-underline-position:below; cursor:pointer; color:blue" @onclick="@(() => OnClickViewDetails(t.TodoId))">@t.TodoId</td>
                        <td>@t.UserId</td>
                        <td>@t.TodoTitle</td>
                        <td>
                            <button type="button" class="btn btn-primary" @onclick="@(() => OnClickViewDetails(@t.TodoId))">View Details</button>
                            <button type="button" class="btn btn-danger btn-sm" @onclick="()=> OpenDeleteDialog(t)">Delete</button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div class="p-2 grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>TODO ID</th>
                    <th>User ID</th>
                    <th>Title</th>
                    <th>Todo Status</th>
                    <th>Button click</th>

                </tr>
            </thead>
            <tbody>

                <tr>
                    <td style="text-underline-position:below; cursor:pointer; color:blue" @onclick="@(() => OnClickViewDetails(@TodoDetailsFromTodoSearch.TodoId))">@TodoDetailsFromTodoSearch.TodoId</td>
                    <td>@TodoDetailsFromTodoSearch.UserId</td>
                    <td>@TodoDetailsFromTodoSearch.TodoTitle</td>
                    <td>@TodoDetailsFromTodoSearch.TodoStatus</td>
                    <td>
                        <button type="button" class="btn btn-primary" @onclick="@(() => OnClickViewDetails(@TodoDetailsFromTodoSearch.TodoId))">View Details</button>
                        <button type="button" class="btn btn-danger btn-sm" @onclick="()=> OpenDeleteDialog(TodoDetailsFromTodoSearch)">Delete</button>
                    </td>
                </tr>

            </tbody>
        </table>
    </div>
}


<div>
    <button class="sign-button btn btn-primary" @onclick="@OnClickGoToCreateTodo">Create new Todo</button>
</div>
@if (DeleteDialogOpen)
{
    <DeleteTodoDialog Title="Are you sure?" Text="Do you want to delete this entry?" OnClose="@OnDeleteDialogClose"></DeleteTodoDialog>
}

@*<div>
    @foreach(TodoBasicInfoDto t in Todos)
    {
        <TodoElement TodoBasicInfoDto="t"></TodoElement>
    }
</div>*@
